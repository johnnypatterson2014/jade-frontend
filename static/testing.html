<div dir="ltr">
  <div style="color:rgb(204,204,204);font-family:monospace;font-size:13px;line-height:17px;">
    <div class="adM"><br></div>
    <div><span style="color:rgb(197,134,192)">import</span> <span style="color:rgb(78,201,176)">numpy</span> <span
        style="color:rgb(197,134,192)">as</span> <span style="color:rgb(78,201,176)">np</span></div>
    <div><span style="color:rgb(197,134,192)">import</span> <span style="color:rgb(78,201,176)">math</span></div>
    <div><span style="color:rgb(197,134,192)">import</span> <span style="color:rgb(78,201,176)">sympy</span> <span
        style="color:rgb(197,134,192)">as</span> <span style="color:rgb(78,201,176)">sympy</span></div>
    <div><span style="color:rgb(197,134,192)">from</span> <span style="color:rgb(78,201,176)">sympy</span>.<span
        style="color:rgb(78,201,176)">utilities</span>.<span style="color:rgb(78,201,176)">lambdify</span> <span
        style="color:rgb(197,134,192)">import</span> <span style="color:rgb(220,220,170)">lambdify</span></div><br>
    <div><span style="color:rgb(106,153,85)"># ------------------------------<wbr>-------</span></div>
    <div><span style="color:rgb(106,153,85)"># Introduction to Symbolic Computation with `SymPy`</span></div><br>
    <div><span style="color:rgb(106,153,85)"># use SymPy to declare expressions with variables</span></div>
    <div><span style="color:rgb(106,153,85)"># let's use: 2x^2 - xy</span></div>
    <div><span style="color:rgb(156,220,254)">x</span>, <span style="color:rgb(156,220,254)">y</span> <span
        style="color:rgb(212,212,212)">=</span> <span style="color:rgb(78,201,176)">sympy</span>.<span
        style="color:rgb(220,220,170)">symbols</span>(<span style="color:rgb(206,145,120)">'x y'</span>)</div>
    <div><span style="color:rgb(156,220,254)">expr</span> <span style="color:rgb(212,212,212)">=</span> <span
        style="color:rgb(181,206,168)">2</span> <span style="color:rgb(212,212,212)">*</span> <span
        style="color:rgb(156,220,254)">x</span><span style="color:rgb(212,212,212)">**</span><span
        style="color:rgb(181,206,168)">2</span> <span style="color:rgb(212,212,212)">-</span> <span
        style="color:rgb(156,220,254)">x</span> <span style="color:rgb(212,212,212)">*</span> <span
        style="color:rgb(156,220,254)">y</span></div><br>
    <div><span style="color:rgb(106,153,85)"># Now you can perform various manipulations with this expression: </span>
    </div>
    <div><span style="color:rgb(106,153,85)"># add or subtract some terms, multiply by other expressions etc., </span>
    </div>
    <div><span style="color:rgb(106,153,85)"># just like if you were doing it by hand</span></div>
    <div><span style="color:rgb(156,220,254)">expr_manip</span> <span style="color:rgb(212,212,212)">=</span> <span
        style="color:rgb(156,220,254)">x</span> <span style="color:rgb(212,212,212)">*</span> (<span
        style="color:rgb(156,220,254)">expr</span> <span style="color:rgb(212,212,212)">+</span> <span
        style="color:rgb(156,220,254)">x</span> <span style="color:rgb(212,212,212)">*</span> <span
        style="color:rgb(156,220,254)">y</span> <span style="color:rgb(212,212,212)">+</span> <span
        style="color:rgb(156,220,254)">x</span><span style="color:rgb(212,212,212)">**</span><span
        style="color:rgb(181,206,168)">3</span>) &nbsp;<span style="color:rgb(106,153,85)"># result: x * (x^3 +
        2x^2)</span></div><br>
    <div><span style="color:rgb(106,153,85)"># You can also expand the expression:</span></div>
    <div><span style="color:rgb(78,201,176)">sympy</span>.<span style="color:rgb(220,220,170)">expand</span>(<span
        style="color:rgb(156,220,254)">expr_manip</span>) &nbsp;<span style="color:rgb(106,153,85)"># result: x^4 +
        2x^3</span></div><br>
    <div><span style="color:rgb(106,153,85)"># Or factorise it:</span></div>
    <div><span style="color:rgb(78,201,176)">sympy</span>.<span style="color:rgb(220,220,170)">factor</span>(<span
        style="color:rgb(156,220,254)">expr_manip</span>) &nbsp;<span style="color:rgb(106,153,85)"># result: x^3 (x +
        2)</span></div><br>
    <div><span style="color:rgb(106,153,85)"># To substitute particular values for the variables in the
        expression:</span></div>
    <div><span style="color:rgb(156,220,254)">expr</span>.evalf(<span style="color:rgb(156,220,254)">subs</span><span
        style="color:rgb(212,212,212)">=</span>{<span style="color:rgb(156,220,254)">x</span>:<span
        style="color:rgb(212,212,212)">-</span><span style="color:rgb(181,206,168)">1</span>, <span
        style="color:rgb(156,220,254)">y</span>:<span style="color:rgb(181,206,168)">2</span>}) &nbsp;<span
        style="color:rgb(106,153,85)"># result: 4.0</span></div><br>
    <div><span style="color:rgb(106,153,85)"># To evaluate the expression on an array of values:</span></div>
    <div><span style="color:rgb(156,220,254)">x_array</span> <span style="color:rgb(212,212,212)">=</span> <span
        style="color:rgb(78,201,176)">np</span>.<span style="color:rgb(220,220,170)">array</span>([<span
        style="color:rgb(181,206,168)">1</span>, <span style="color:rgb(181,206,168)">2</span>, <span
        style="color:rgb(181,206,168)">3</span>])</div><br>
    <div><span style="color:rgb(106,153,85)"># first, you need to make a function `NumPy`-friendly first using
        lambdify:</span></div>
    <div><span style="color:rgb(156,220,254)">f_symb_numpy</span> <span style="color:rgb(212,212,212)">=</span> <span
        style="color:rgb(220,220,170)">lambdify</span>(<span style="color:rgb(156,220,254)">x</span>, <span
        style="color:rgb(156,220,254)">expr</span>, <span style="color:rgb(206,145,120)">'numpy'</span>)</div><br>
    <div><span style="color:rgb(106,153,85)"># now run the expr with an array as input:</span></div>
    <div><span style="color:rgb(156,220,254)">f_symb_numpy</span>(<span style="color:rgb(156,220,254)">x_array</span>)
    </div><br>
    <div><span style="color:rgb(106,153,85)"># ------------------------------<wbr>-------</span></div>
    <div><span style="color:rgb(106,153,85)"># Symbolic Differentiation with `SymPy`</span></div><br>
    <div><span style="color:rgb(106,153,85)"># Let's try to find a derivative of a simple power function using
        `SymPy`:</span></div>
    <div><span style="color:rgb(78,201,176)">sympy</span>.<span style="color:rgb(220,220,170)">diff</span>(<span
        style="color:rgb(156,220,254)">x</span><span style="color:rgb(212,212,212)">**</span><span
        style="color:rgb(181,206,168)">3</span>,<span style="color:rgb(156,220,254)">x</span>) &nbsp;<span
        style="color:rgb(106,153,85)"># result: 3x^2</span></div><br>
    <div><span style="color:rgb(106,153,85)"># Some standard functions can be used in the expression, and `SymPy`
      </span></div>
    <div><span style="color:rgb(106,153,85)"># will apply required rules (sum, product, chain) to calculate the
        derivative:</span></div>
    <div><span style="color:rgb(156,220,254)">dfdx_composed</span> <span style="color:rgb(212,212,212)">=</span> <span
        style="color:rgb(78,201,176)">sympy</span>.<span style="color:rgb(220,220,170)">diff</span>(<span
        style="color:rgb(78,201,176)">sympy</span>.<span style="color:rgb(78,201,176)">exp</span>(<span
        style="color:rgb(212,212,212)">-</span><span style="color:rgb(181,206,168)">2</span><span
        style="color:rgb(212,212,212)">*</span><span style="color:rgb(156,220,254)">x</span>) <span
        style="color:rgb(220,220,170)">+</span> <span style="color:rgb(181,206,168)">3</span><span
        style="color:rgb(212,212,212)">*</span><span style="color:rgb(78,201,176)">sympy</span>.<span
        style="color:rgb(78,201,176)">sin</span>(<span style="color:rgb(181,206,168)">3</span><span
        style="color:rgb(212,212,212)">*</span><span style="color:rgb(156,220,254)">x</span>), <span
        style="color:rgb(156,220,254)">x</span>)</div>
    <div><span style="color:rgb(106,153,85)"># result: 9cos(3ùë•)‚àí2ùëí^‚àí2ùë•</span></div><br>
    <div><span style="color:rgb(106,153,85)"># Now calculate the derivative of the function `f_symb` </span></div>
    <div><span style="color:rgb(106,153,85)"># and make it `NumPy`-friendly:</span></div>
    <div><span style="color:rgb(156,220,254)">f_symb</span> <span style="color:rgb(212,212,212)">=</span> <span
        style="color:rgb(156,220,254)">x</span> <span style="color:rgb(212,212,212)">**</span> <span
        style="color:rgb(181,206,168)">2</span></div>
    <div><span style="color:rgb(156,220,254)">dfdx_symb</span> <span style="color:rgb(212,212,212)">=</span> <span
        style="color:rgb(78,201,176)">sympy</span>.<span style="color:rgb(220,220,170)">diff</span>(<span
        style="color:rgb(156,220,254)">f_symb</span>, <span style="color:rgb(156,220,254)">x</span>)</div>
    <div><span style="color:rgb(156,220,254)">dfdx_symb_numpy</span> <span style="color:rgb(212,212,212)">=</span> <span
        style="color:rgb(220,220,170)">lambdify</span>(<span style="color:rgb(156,220,254)">x</span>, <span
        style="color:rgb(156,220,254)">dfdx_symb</span>, <span style="color:rgb(206,145,120)">'numpy'</span>)</div><br>
    <div><span style="color:rgb(106,153,85)"># Evaluate function `dfdx_symb_numpy` for each element of the
        `x_array`:</span></div>
    <div><span style="color:rgb(156,220,254)">f_prime_x</span> <span style="color:rgb(212,212,212)">=</span> <span
        style="color:rgb(156,220,254)">dfdx_symb_numpy</span>(<span style="color:rgb(156,220,254)">x_array</span>)</div>
    <div><span style="color:rgb(106,153,85)"># f'(x) = 2x</span></div>
    <div><span style="color:rgb(106,153,85)"># f_prime_x = [2 4 6]</span></div><br>
    <div><span style="color:rgb(106,153,85)">### note: Symbolic Differentiation has some limitations. Sometimes the
        output </span></div>
    <div><span style="color:rgb(106,153,85)"># expressions are too complicated and even not possible to evaluate. For
      </span></div>
    <div><span style="color:rgb(106,153,85)"># example, the derivative of the function |x| is undefined at zero. </span>
    </div><br>
    <div><span style="color:rgb(106,153,85)">### note: an alternate approach to calculating the derivative is to do
        a</span></div>
    <div><span style="color:rgb(106,153,85)"># numerical approximation. One method is the np.gradient function from
        numpy:</span></div>
    <div><span style="color:rgb(156,220,254)">x_array_2</span> <span style="color:rgb(212,212,212)">=</span> <span
        style="color:rgb(78,201,176)">np</span>.<span style="color:rgb(220,220,170)">linspace</span>(<span
        style="color:rgb(212,212,212)">-</span><span style="color:rgb(181,206,168)">5</span>, <span
        style="color:rgb(181,206,168)">5</span>, <span style="color:rgb(181,206,168)">100</span>)</div>
    <div><span style="color:rgb(156,220,254)">dfdx_numerical</span> <span style="color:rgb(212,212,212)">=</span> <span
        style="color:rgb(78,201,176)">np</span>.<span style="color:rgb(220,220,170)">gradient</span>(f(<span
        style="color:rgb(156,220,254)">x_array_2</span>), <span style="color:rgb(156,220,254)">x_array_2</span>)</div>
    <br>
    <div><span style="color:rgb(106,153,85)"># ------------------------------<wbr>-------</span></div>
    <div><span style="color:rgb(106,153,85)"># Automatic Differentiation with `JAX` </span></div>
    <div><span style="color:rgb(106,153,85)">#</span></div>
    <div><span style="color:rgb(106,153,85)"># **Automatic differentiation** (autodiff) method breaks down the function
      </span></div>
    <div><span style="color:rgb(106,153,85)"># into common functions ($sin$, $cos$, $log$, power functions, etc.), and
      </span></div>
    <div><span style="color:rgb(106,153,85)"># constructs the computational graph consisting of the basic functions.
      </span></div>
    <div><span style="color:rgb(106,153,85)"># Then the chain rule is used to compute the derivative at any node of the
      </span></div>
    <div><span style="color:rgb(106,153,85)"># graph. It is the most commonly used approach in machine learning </span>
    </div>
    <div><span style="color:rgb(106,153,85)"># applications and neural networks, as the computational graph for the
      </span></div>
    <div><span style="color:rgb(106,153,85)"># function and its derivatives can be built during the construction of the
      </span></div>
    <div><span style="color:rgb(106,153,85)"># neural network, saving in future computations.</span></div>
    <div><span style="color:rgb(106,153,85)">#</span></div>
    <div><span style="color:rgb(106,153,85)"># `Autograd` and `JAX` are the most commonly used frameworks to build
      </span></div>
    <div><span style="color:rgb(106,153,85)"># neural networks. `JAX` brings together `Autograd` functionality for
      </span></div>
    <div><span style="color:rgb(106,153,85)"># optimization problems, and `XLA` (Accelerated Linear Algebra) compiler
      </span></div>
    <div><span style="color:rgb(106,153,85)"># for parallel computing.</span></div>
  </div>
</div>